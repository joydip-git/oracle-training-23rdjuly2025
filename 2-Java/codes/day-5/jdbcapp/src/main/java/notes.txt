package jdbcapp;
//import oracle.jdbc.driver.OracleDriver;

import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Connection;
import java.sql.Statement;

public class App {

	public static void main(String[] args) throws SQLException {
		Connection connection = null;
		String query = "select * from products";
		Statement statement = null;
		// A table of data representing a database result set, which is usually
		// generated by executing a statement that queries the database.
		ResultSet result = null;

		try {
			// 1. loading JDBC driver class dynamically
			Class.forName("oracle.jdbc.driver.OracleDriver");

			// 2. create connection
			connection = DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:orcl", "system", "Oracle@2024");
			// check whether connection is open or closed
			// System.out.println(connection.isClosed() ? "closed" : "open");

			// 3. create statement
			statement = connection.createStatement();

			// 4. execute the query (executeQuery() -> to execute select queries)
			result = statement.executeQuery(query);

			// 5. read the data
			while (result.next()) {
				StringBuilder builder = new StringBuilder();

				builder.append(result.getInt("product_id") + "\t");
				builder.append(result.getString("product_name") + "\t");
				builder.append(result.getFloat("product_price") + "\t");
				builder.append(result.getString("product_desc") + "\t");
				builder.append(result.getInt("category_id"));

				System.out.println(builder.toString());
			}

		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			// 6. close the connection
			if (connection != null)
				connection.close();
		}
	}
}







